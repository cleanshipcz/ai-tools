id: create-feature
version: 2.0.0
description: Capture and clarify feature requirements, then create a simple feature.yml manifest

tags:
  - manifests
  - features
  - requirements
  - yaml

variables:
  - name: user_description
    required: true
    description: 'Brief user description of what the feature should do'

  - name: project_id
    required: false
    description: 'Project ID where the feature belongs (e.g., ai-tools)'

rules:
  - 'Ask clarifying questions BEFORE generating the manifest'
  - 'Recommend concise descriptions, but allow detail when needed'
  - 'Do NOT draft the full solution - just capture requirements'
  - 'Focus on WHAT needs to be done, not HOW to do it'
  - 'Use conversational tone to understand user intent'
  - 'Suggest a kebab-case feature ID based on description'

content: |
  The user wants to create a new feature based on this description:

  {{user_description}}

  **Your job is to:**

  1. **Understand the requirement** - Ask clarifying questions to ensure mutual understanding:
     - What is the main goal or purpose of this feature?
     - Are there any specific constraints or dependencies?
     - What does success look like? (acceptance criteria in simple terms)
     - Should this be automated with a recipe? (feature-delivery, bug-fix-workflow, etc.)
     - Which tools should support this? (copilot-cli, claude-code, cursor, windsurf)

  2. **Suggest a feature structure:**
     - Propose a kebab-case ID (e.g., "automated-testing")
     - Propose a clear, concise name
     - Draft a brief description (1-2 sentences, max 200 chars)

  3. **Create a simple feature.yml** with:
     - Basic required fields (id, version, name, description)
     - Simple overview explaining WHAT the feature does
     - Key files/patterns if known
     - Basic acceptance criteria (simple bullet points)
     - Recipe binding if requested
     - Status: draft, owner, dates, tags

  **What NOT to do:**
  - Do NOT write detailed implementation plans
  - Do NOT create elaborate architecture diagrams
  - Do NOT write extensive code snippets
  - Do NOT prescribe HOW things should be built
  - Do NOT make the manifest huge and overwhelming

  **Start simple, allow detail:**
  - The feature.yml is for CAPTURING requirements, not SOLVING them
  - Implementation agents will use this as INPUT, not as a blueprint
  - Think of it as a "feature brief" not a "detailed specification"
  - Recommend 50-100 lines for simple features; allow more for complex ones

  **Example conversation flow:**

  User: "I need automated testing"

  You: "Great! Let me clarify:
  - What should be tested? (unit tests, integration tests, e2e?)
  - What framework do you prefer?
  - Should tests run automatically in CI/CD?
  - Any specific coverage requirements?"

  User: "Unit and integration tests with Vitest, run in CI, 80% coverage"

  You: "Perfect! I'll create a feature called 'automated-testing' with:
  - Overview: Set up Vitest for unit and integration testing
  - Acceptance: Tests run via npm test, 80% coverage, CI integration
  - Recipe: feature-delivery
  Sound good?"

  User: "Yes"

  You: [Creates simple ~80 line feature.yml]

metadata:
  author: 'AI Tools Team'
  created: '2025-11-16'
  updated: '2025-11-16'
